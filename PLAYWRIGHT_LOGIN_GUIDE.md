# ğŸ¯ æ–¹æ¡ˆ1ï¼šPlaywrightè‡ªåŠ¨ç™»å½•è¯¦ç»†æŒ‡å—

## ğŸ“Œ å®Œæ•´æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šæ‰“å¼€ç»ˆç«¯

**æ–¹æ³•1ï¼šä½¿ç”¨PowerShell**
1. æŒ‰ `Win + X`
2. é€‰æ‹© "Windows PowerShell" æˆ– "ç»ˆç«¯(ç®¡ç†å‘˜)"
3. è¿›å…¥é¡¹ç›®ç›®å½•ï¼š
```powershell
cd C:\Users\Gigabyte\.minimax-agent-cn\projects\1\media-automation
```

**æ–¹æ³•2ï¼šä½¿ç”¨CMD**
1. æŒ‰ `Win + R`
2. è¾“å…¥ `cmd`ï¼Œå›è½¦
3. è¿›å…¥é¡¹ç›®ç›®å½•ï¼š
```cmd
cd /d C:\Users\Gigabyte\.minimax-agent-cn\projects\1\media-automation
```

---

### ç¬¬äºŒæ­¥ï¼šå®‰è£…Playwright

åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
# 1. å®‰è£…Playwrightåº“
pip install playwright
```

```powershell
# 2. å®‰è£…Chromiumæµè§ˆå™¨ï¼ˆPlaywrightéœ€è¦ï¼‰
playwright install chromium
```

**ç­‰å¾…å®Œæˆ**ï¼Œè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼ˆä¸‹è½½æµè§ˆå™¨çº¦100MBï¼‰ã€‚

**éªŒè¯å®‰è£…**ï¼š
```powershell
python -c "from playwright.sync_api import sync_playwright; print('âœ… Playwrightå®‰è£…æˆåŠŸ')"
```

å¦‚æœçœ‹åˆ° `âœ… Playwrightå®‰è£…æˆåŠŸ` åˆ™ç»§ç»­ä¸‹ä¸€æ­¥ã€‚

---

### ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œç™»å½•å·¥å…·

åœ¨é¡¹ç›®ç›®å½•æ‰§è¡Œï¼š

```powershell
python tools\get_xhs_cookies.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
==================================================
ğŸ± å°çº¢ä¹¦ Cookies è·å–å·¥å…· (Playwrightç‰ˆ)
==================================================

ğŸš€ å¯åŠ¨æµè§ˆå™¨...
ğŸ“± æ‰“å¼€å°çº¢ä¹¦ç™»å½•é¡µé¢...
â³ è¯·åœ¨æµè§ˆå™¨ä¸­å®Œæˆç™»å½•...
   1. ç‚¹å‡»ç™»å½•æŒ‰é’®
   2. ä½¿ç”¨æ‰‹æœºå· 13810119101 ç™»å½•
   3. å®ŒæˆçŸ­ä¿¡éªŒè¯ç éªŒè¯
```

**å°†ä¼šå‘ç”Ÿ**ï¼š
- è‡ªåŠ¨æ‰“å¼€Chromeæµè§ˆå™¨çª—å£ï¼ˆ1280x720å¤§å°ï¼‰
- è®¿é—®å°çº¢ä¹¦é¦–é¡µ
- **ä¸è¦å…³é—­è¿™ä¸ªæµè§ˆå™¨çª—å£ï¼**

---

### ç¬¬å››æ­¥ï¼šåœ¨æµè§ˆå™¨ä¸­å®Œæˆç™»å½•

#### 4.1 è§‚å¯Ÿé¡µé¢çŠ¶æ€
æµè§ˆå™¨çª—å£æ‰“å¼€åï¼Œæ‚¨åº”è¯¥çœ‹åˆ°å°çº¢ä¹¦é¦–é¡µã€‚

#### 4.2 ç‚¹å‡»ç™»å½•
- åœ¨é¡µé¢å³ä¸Šè§’æ‰¾åˆ° **"ç™»å½•"** æŒ‰é’®
- ç‚¹å‡»å®ƒ

#### 4.3 é€‰æ‹©ç™»å½•æ–¹å¼
é€‰æ‹© **"æ‰‹æœºå·ç™»å½•"**

#### 4.4 è¾“å…¥æ‰‹æœºå·
- åœ¨æ‰‹æœºå·è¾“å…¥æ¡†ä¸­è¾“å…¥ï¼š**13810119101**
- ç‚¹å‡» **"è·å–éªŒè¯ç "**

#### 4.5 æŸ¥çœ‹çŸ­ä¿¡éªŒè¯ç 
æ£€æŸ¥æ‚¨çš„æ‰‹æœºçŸ­ä¿¡ï¼Œåº”è¯¥ä¼šæ”¶åˆ°å°çº¢ä¹¦çš„éªŒè¯ç ï¼ˆ4-6ä½æ•°å­—ï¼‰ã€‚

#### 4.6 è¾“å…¥éªŒè¯ç 
- åœ¨éªŒè¯ç è¾“å…¥æ¡†ä¸­è¾“å…¥æ”¶åˆ°çš„æ•°å­—
- ç‚¹å‡» **"ç™»å½•"** æˆ– **"ç¡®å®š"**

#### 4.7 éªŒè¯ç™»å½•æˆåŠŸ
- é¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°æˆ–è·³è½¬åˆ°é¦–é¡µ
- å³ä¸Šè§’åº”è¯¥æ˜¾ç¤ºæ‚¨çš„å¤´åƒæˆ–ç”¨æˆ·å
- å¦‚æœè¦æ±‚å…¶ä»–éªŒè¯ï¼ˆå¦‚æ»‘å—éªŒè¯ï¼‰ï¼Œè¯·å®Œæˆå®ƒ

---

### ç¬¬äº”æ­¥ï¼šç­‰å¾…è‡ªåŠ¨ä¿å­˜

ç™»å½•æˆåŠŸåï¼Œ**ä¿æŒæµè§ˆå™¨çª—å£æ‰“å¼€çº¦5-10ç§’**ã€‚

å·¥å…·ä¼šè‡ªåŠ¨ï¼š
1. âœ… æ£€æµ‹åˆ°ç™»å½•æˆåŠŸï¼ˆé€šè¿‡cookiesï¼‰
2. âœ… è·å–æ‰€æœ‰cookies
3. âœ… å…³é—­æµè§ˆå™¨
4. âœ… ä¿å­˜cookiesåˆ°æ–‡ä»¶

**é¢„æœŸè¾“å‡º**ï¼š
```
âœ… æ£€æµ‹åˆ°ç™»å½•æˆåŠŸï¼

ğŸ“Š è·å–åˆ° 5 ä¸ªcookies

å…³é”®cookies:
  âœ… web_session: xxxxxxxx...
  âœ… a1: xxxxxxxx...
  âœ… webid: xxxxxxxx...

âœ… Cookieså·²ä¿å­˜åˆ°: C:\Users\Gigabyte\.minimax-agent-cn\projects\1\media-automation\data\xhs_cookies.txt
âœ… JSONæ ¼å¼å·²ä¿å­˜åˆ°: C:\Users\Gigabyte\.minimax-agent-cn\projects\1\media-automation\data\xhs_cookies.json

==================================================
ğŸ‰ å®Œæˆï¼
==================================================

ä¸‹ä¸€æ­¥æ“ä½œ:
  1. Cookieså·²ä¿å­˜åˆ°: data\xhs_cookies.txt
  2. ä¸Šä¼ åˆ°æœåŠ¡å™¨:
     scp data/xhs_cookies.txt root@43.129.244.154:/opt/xhs-automation/data/
```

---

### ç¬¬å…­æ­¥ï¼šéªŒè¯æœ¬åœ°ä¿å­˜

æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š

```powershell
# æ£€æŸ¥æ–‡ä»¶
dir data\xhs_cookies.txt

# æŸ¥çœ‹å†…å®¹ï¼ˆå‰500å­—ç¬¦ï¼‰
powershell -Command "Get-Content data\xhs_cookies.txt | Select-Object -First 5"
```

**åº”è¯¥çœ‹åˆ°ç±»ä¼¼**ï¼š
```
web_session=xxxxx; a1=xxxxx; webid=xxxxx; xhs_tracker_id=xxxxx; tube_scene=xxxxx
```

---

### ç¬¬ä¸ƒæ­¥ï¼šä¸Šä¼ åˆ°æœåŠ¡å™¨

**åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ**ï¼š

```powershell
# ä¸Šä¼ cookiesæ–‡ä»¶
scp data\xhs_cookies.txt root@43.129.244.154:/opt/xhs-automation/data/

# è¾“å…¥å¯†ç ï¼ˆå¦‚æœè¦æ±‚ï¼‰ï¼šAmir1145993ï¼
```

**å¦‚æœscpä¸å¯ç”¨**ï¼Œå°è¯•ç”¨å…¶ä»–æ–¹æ³•ï¼š

**æ–¹æ³•Aï¼šä½¿ç”¨PowerShellè¿œç¨‹æ‰§è¡Œ**
```powershell
# ç›´æ¥å°†å†…å®¹å‘é€åˆ°æœåŠ¡å™¨
$content = Get-Content data\xhs_cookies.txt -Raw
$session = New-PSSession -HostName 43.129.244.154 -UserName root
Enter-PSSession $session
# åœ¨è¿œç¨‹ä¼šè¯ä¸­æ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶
```

**æ–¹æ³•Bï¼šæ‰‹åŠ¨å¤åˆ¶**
1. æ‰“å¼€ `data\xhs_cookies.txt`
2. å¤åˆ¶å…¨éƒ¨å†…å®¹
3. ç™»å½•æœåŠ¡å™¨ï¼š`ssh root@43.129.244.154`
4. æ‰§è¡Œï¼š
```bash
cd /opt/xhs-automation/data
echo "ç²˜è´´çš„å†…å®¹" > xhs_cookies.txt
```

---

### ç¬¬å…«æ­¥ï¼šæœåŠ¡å™¨éªŒè¯

ç™»å½•æœåŠ¡å™¨éªŒè¯ï¼š

```powershell
# ç™»å½•æœåŠ¡å™¨
ssh root@43.129.244.154

# éªŒè¯cookies
cd /opt/xhs-automation
python3 -c "
from scripts.xhs_cookies import XhsCookies
if XhsCookies.validate():
    print('âœ… Cookiesæœ‰æ•ˆï¼Œå¯ä»¥å‘å¸ƒå†…å®¹ï¼')
else:
    print('âŒ Cookiesæ— æ•ˆï¼Œéœ€è¦é‡æ–°è·å–')
    print('å½“å‰cookiesæ•°é‡:', len(XhsCookies.load()))
"
```

---

## ğŸ”§ å¸¸è§é—®é¢˜å¤„ç†

### Q1: æç¤º"playwright not installed"
**è§£å†³**ï¼š
```powershell
pip install playwright
playwright install chromium
```

### Q2: æµè§ˆå™¨æ‰“ä¸å¼€/é—ªé€€
**è§£å†³**ï¼š
```powershell
# æ›´æ–°playwright
pip install --upgrade playwright
playwright install --force chromium
```

### Q3: ç™»å½•è¶…æ—¶ï¼ˆ120ç§’ä¸å¤Ÿï¼‰
**ä¿®æ”¹è¶…æ—¶æ—¶é—´**ï¼š
ç¼–è¾‘ `tools\get_xhs_cookies.py`ï¼Œæ‰¾åˆ°ï¼š
```python
timeout=120000  # 120ç§’è¶…æ—¶
```
æ”¹ä¸ºï¼š
```python
timeout=300000  # 300ç§’è¶…æ—¶
```

### Q4: æç¤º"web_session"æˆ–"a1"æœªæ‰¾åˆ°
**åŸå› **ï¼šç™»å½•æœªæˆåŠŸå®Œæˆ
**è§£å†³**ï¼š
1. é‡æ–°è¿è¡Œå·¥å…·
2. ç¡®ä¿çœ‹åˆ°å³ä¸Šè§’æ˜¾ç¤ºå¤´åƒ
3. ç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½

### Q5: scpå‘½ä»¤ä¸å¯ç”¨
**è§£å†³**ï¼š
1. æ‰“å¼€ **è®¾ç½®** â†’ **åº”ç”¨** â†’ **å¯é€‰åŠŸèƒ½**
2. æ£€æŸ¥æ˜¯å¦å®‰è£…äº† **OpenSSHå®¢æˆ·ç«¯**
3. å¦‚æœæ²¡æœ‰ï¼Œå®‰è£…å®ƒï¼š
```powershell
Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0
```

### Q6: Cookiesè¿‡æœŸï¼ˆè¿‡å‡ å¤©åï¼‰
**ç—‡çŠ¶**ï¼š
```
âŒ Error: å°çº¢ä¹¦ç™»å½•å·²è¿‡æœŸ
```

**è§£å†³**ï¼š
1. é‡æ–°æ‰§è¡Œæ–¹æ¡ˆ1è·å–æ–°cookies
2. ä¸Šä¼ åˆ°æœåŠ¡å™¨
3. é‡å¯å‘å¸ƒæœåŠ¡ï¼š
```bash
cd /opt/xhs-automation
docker-compose restart cloud-publisher
```

---

## âœ… æœ€ç»ˆéªŒè¯æ¸…å•

å®Œæˆæ‰€æœ‰æ­¥éª¤åï¼Œç¡®è®¤ï¼š

- [ ] æœ¬åœ° `data\xhs_cookies.txt` æ–‡ä»¶å­˜åœ¨ä¸”æœ‰å†…å®¹
- [ ] æœåŠ¡å™¨ `/opt/xhs-automation/data/xhs_cookies.txt` æ–‡ä»¶å­˜åœ¨
- [ ] è¿è¡Œ `python3 -c "..."` æ˜¾ç¤º `âœ… Cookiesæœ‰æ•ˆ`
- [ ] å¯ä»¥ç»§ç»­é…ç½®GitHub Webhookäº†

---

## âš ï¸ é‡è¦æé†’

1. **cookiesæœ‰æ•ˆæœŸ**ï¼šé€šå¸¸7-30å¤©
2. **ä¸è¦é€€å‡ºç™»å½•**ï¼šåœ¨å°çº¢ä¹¦APPä¸­ä¸è¦é€€å‡ºwebç™»å½•
3. **å¤šè®¾å¤‡é™åˆ¶**ï¼šæ£€æŸ¥APPè®¾ç½®ä¸­çš„è®¾å¤‡ç™»å½•é™åˆ¶
4. **å®‰å…¨**ï¼šä¸è¦å°†cookiesåˆ†äº«ç»™ä»–äºº

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨æ‚¨å¯ä»¥ç»§ç»­ä¸‹ä¸€æ­¥ï¼š**é…ç½®GitHub Webhook**

éœ€è¦æˆ‘ç»§ç»­ååŠ©å—ï¼Ÿ
